<IfModule mod_rewrite.c>
  RewriteEngine On

  # Serve files if they exist
  RewriteCond %{REQUEST_FILENAME} -f
  RewriteRule ^ - [L]

  # Handle "pretty" routes like /perk â†’ perk.html (run before directory check)
  RewriteCond %{REQUEST_URI} !/$
  RewriteCond %{REQUEST_FILENAME}.html -f
  RewriteRule ^ %{REQUEST_URI}.html [L]

  # If request matches a directory, serve index.html inside it
  RewriteCond %{REQUEST_FILENAME} -d
  RewriteRule ^ - [L]

  # Redirect /foo.html to /foo (remove .html extension)
  RewriteCond %{REQUEST_FILENAME} !-f
  RewriteCond %{REQUEST_FILENAME} !-d
  RewriteRule ^(.+)\.html$ /$1 [R=301,L]

  ErrorDocument 404 /404.html
  ErrorDocument 403 /404.html
</IfModule>